<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tournament Badminton Bracket - Merdeka!</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tambahkan Firebase Auth SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Bebas+Neue&display=swap'); /* Font untuk judul yang lebih berani */

        body {
            /* Latar belakang dari Google Drive */
            background-image: url('https://drive.google.com/uc?export=view&id=1N0nU29Lv79FGYM9OIWIld3VZpEBzyySs');
            background-size: cover; /* Menutupi seluruh area */
            background-position: center; /* Pusatkan gambar */
            background-repeat: no-repeat; /* Jangan ulangi gambar */
            background-attachment: fixed; /* Agar gambar tetap saat scroll */
            font-family: 'Poppins', sans-serif;
            /* overflow-x: hidden; */ /* Dihapus untuk memungkinkan scroll horizontal */
            overflow-x: auto; /* Memungkinkan scroll horizontal jika konten melebihi lebar */
            position: relative;
            min-height: 100vh;
            /* Tambahkan overlay untuk kontras teks */
            background-color: rgba(255, 0, 0, 0.2); /* Merah transparan sebagai fallback/overlay */
            background-blend-mode: overlay; /* Campurkan warna overlay dengan gambar */
        }

        /* Efek Partikel Latar Belakang (Konfeti) */
        .background-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1; /* Di belakang semua konten */
            overflow: hidden;
        }

        .particle {
            position: absolute;
            background-color: rgba(255, 255, 255, 0.9); /* Putih lebih solid */
            border-radius: 50%;
            animation: particle-fall linear infinite;
            opacity: 0;
        }

        .particle:nth-child(2n) { background-color: rgba(255, 0, 0, 0.9); /* Merah lebih solid */ }
        .particle:nth-child(3n) { background-color: rgba(255, 215, 0, 0.9); /* Emas lebih solid */ }

        @keyframes particle-fall {
            0% { transform: translateY(-15vh) scale(0.3); opacity: 0; } /* Mulai lebih tinggi, lebih kecil */
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(100vh) scale(1.5); opacity: 0; } /* Jatuh lebih jauh, lebih besar */
        }

        /* Efek Kembang Api */
        .firework {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-radius: 50%;
            opacity: 0;
            animation: firework-burst 1.8s ease-out forwards; /* Durasi lebih panjang */
            z-index: 9999; /* Pastikan di atas segalanya */
            pointer-events: none;
        }

        .firework::before, .firework::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            animation: firework-spark 1.8s ease-out forwards; /* Durasi lebih panjang */
        }

        .firework::before { background-color: #FF0000; } /* Merah */
        .firework::after { background-color: #FFD700; animation-delay: 0.15s; } /* Emas, delay lebih panjang */
        .firework:nth-child(3n)::before { background-color: #FFFFFF; animation-delay: 0.3s; } /* Putih */


        @keyframes firework-burst {
            0% { width: 0; height: 0; opacity: 1; }
            100% { width: 250px; height: 250px; opacity: 0; } /* Lebih besar */
        }

        @keyframes firework-spark {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; } /* Spark lebih besar */
        }


        /* Ornamen Umbul-umbul */
        .umbul-umbul-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 180px; /* Increased height to accommodate diagonal spread and larger size */
            overflow: hidden;
            z-index: 0;
            pointer-events: none;
            display: flex;
            justify-content: space-around; /* Distribute umbul-umbul lebih merata */
            align-items: flex-start;
            padding: 15px 0; /* Add more padding */
        }

        .umbul-umbul {
            position: relative;
            width: 0;
            height: 0;
            border-left: 40px solid transparent; /* Lebih lebar */
            border-right: 40px solid transparent; /* Lebih lebar */
            border-bottom: 100px solid; /* Lebih panjang */
            transform-origin: top center;
            animation: sway 3.5s ease-in-out infinite alternate; /* Durasi lebih panjang, lebih halus */
            opacity: 0.95; /* Lebih solid */
            filter: drop-shadow(0 8px 8px rgba(0,0,0,0.4)); /* Bayangan lebih kuat */
            margin: 0 8px; /* Jarak antar umbul-umbul */
        }

        /* Specific positioning for diagonal umbul-umbul */
        .umbul-umbul:nth-child(odd) {
            transform: rotate(-20deg) translateY(0px); /* Diagonal lebih curam */
            margin-left: -30px; /* Adjust to start from edge */
        }

        .umbul-umbul:nth-child(even) {
            transform: rotate(20deg) translateY(0px); /* Diagonal lebih curam */
            margin-right: -30px; /* Adjust to start from edge */
        }

        /* Adjust animation delay for diagonal effect */
        .umbul-umbul:nth-child(3n+1) { animation-delay: 0s; }
        .umbul-umbul:nth-child(3n+2) { animation-delay: 0.7s; } /* Delay lebih panjang */
        .umbul-umbul:nth-child(3n+3) { animation-delay: 1.4s; } /* Delay lebih panjang */


        @keyframes sway {
            0% { transform: rotate(-20deg) translateY(0px); }
            50% { transform: rotate(-23deg) translateY(-8px); } /* Gerakan sway lebih besar */
            100% { transform: rotate(-17deg) translateY(0px); }
        }

        .umbul-umbul:nth-child(even) {
            animation: sway-even 3.5s ease-in-out infinite alternate;
        }

        @keyframes sway-even {
            0% { transform: rotate(20deg) translateY(0px); }
            50% { transform: rotate(23deg) translateY(-8px); } /* Gerakan sway lebih besar */
            100% { transform: rotate(17deg) translateY(0px); }
        }


        .umbul-umbul.red { border-bottom-color: #FF0000; }
        .umbul-umbul.white { border-bottom-color: #FFFFFF; }


        /* Ornamen Bendera Kecil di Sudut */
        .flag-ornament {
            position: fixed; /* Fixed agar tetap di viewport */
            width: 70px; /* Lebih besar */
            height: 40px; /* Lebih besar */
            background: linear-gradient(to bottom, #FF0000 50%, #FFFFFF 50%);
            border: 3px solid #8B0000; /* Border lebih tebal */
            box-shadow: 0 6px 12px rgba(0,0,0,0.4); /* Bayangan lebih kuat */
            z-index: 10; /* Di atas konten lain */
            pointer-events: none;
            animation: float 5s ease-in-out infinite alternate, rotate-flag 10s linear infinite; /* Animasi lebih panjang dan rotasi */
            transform-origin: bottom left; /* Titik putar untuk bendera */
        }

        .flag-ornament.top-left { top: 25px; left: 25px; animation-delay: 0s; }
        .flag-ornament.top-right { top: 25px; right: 25px; animation-delay: 0.7s; transform-origin: bottom right; }
        .flag-ornament.bottom-left { bottom: 25px; left: 25px; animation-delay: 1.4s; }
        .flag-ornament.bottom-right { bottom: 25px; right: 25px; animation-delay: 2.1s; transform-origin: bottom right; }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-15px); } /* Gerakan float lebih besar */
            100% { transform: translateY(0px); }
        }

        @keyframes rotate-flag {
            0% { transform: rotateY(0deg) rotateX(0deg); }
            25% { transform: rotateY(90deg) rotateX(10deg); }
            50% { transform: rotateY(180deg) rotateX(0deg); }
            75% { transform: rotateY(270deg) rotateX(-10deg); }
            100% { transform: rotateY(360deg) rotateX(0deg); }
        }

        /* Siluet Pahlawan / Monumen */
        .hero-silhouette {
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 350px; /* Ukuran siluet lebih besar */
            height: 250px;
            background-image: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e1/Monumen_Nasional_Jakarta.svg/1200px-Monumen_Nasional_Jakarta.svg.png'); /* Contoh Monas */
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center bottom;
            z-index: 0; /* Di belakang konten utama, di atas partikel */
            opacity: 0.15; /* Lebih terlihat */
            animation: appear-fade 12s ease-out infinite alternate; /* Animasi lebih panjang */
        }

        @keyframes appear-fade {
            0% { opacity: 0.1; transform: translateX(-50%) translateY(25px); }
            50% { opacity: 0.2; transform: translateX(-50%) translateY(0px); }
            100% { opacity: 0.1; transform: translateX(-50%) translateY(25px); }
        }

        /* Pita Merah Putih */
        .ribbon {
            position: absolute;
            top: 160px; /* Di bawah judul, sedikit lebih rendah */
            left: 50%;
            transform: translateX(-50%);
            width: 85%; /* Lebih lebar */
            max-width: 950px;
            height: 35px; /* Lebih tebal */
            background: linear-gradient(to right, #FF0000 50%, #FFFFFF 50%);
            border-radius: 18px; /* Lebih membulat */
            box-shadow: 0 8px 15px rgba(0,0,0,0.4); /* Bayangan lebih kuat */
            z-index: 1;
            animation: ribbon-wave 6s ease-in-out infinite alternate; /* Animasi lebih panjang */
        }

        @keyframes ribbon-wave {
            0% { transform: translateX(-50%) scaleX(1) translateY(0px); }
            50% { transform: translateX(-50%) scaleX(1.03) translateY(-7px); } /* Efek wave lebih besar */
            100% { transform: translateX(-50%) scaleX(1) translateY(0px); }
        }


        .bracket {
            display: flex;
            justify-content: center;
            padding: 2rem 1rem; /* Menambahkan padding horizontal untuk ruang lebih */
            align-items: center;
            position: relative;
            z-index: 1;
            gap: 0.25rem; /* Mengurangi jarak antar round lebih lanjut */
            max-width: 100%; /* Pastikan bracket tidak melebihi lebar viewport */
            box-sizing: border-box;
        }

        .round {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            margin: 0 0.15rem; /* Mengurangi margin horizontal lebih lanjut */
            min-height: 450px; /* Sedikit mengurangi tinggi minimum */
            background: rgba(255, 255, 255, 0.1); /* Latar belakang transparan untuk round */
            border-radius: 15px;
            padding: 0.8rem; /* Sedikit mengurangi padding */
            box-shadow: inset 0 0 10px rgba(255,255,255,0.5); /* Efek kaca */
            flex-grow: 1; /* Memungkinkan round untuk tumbuh mengisi ruang */
            flex-basis: 0; /* Penting untuk flex-grow agar bekerja dengan baik */
            min-width: 180px; /* Lebar minimum untuk round */
            max-width: 20vw; /* Menggunakan unit viewport width untuk responsivitas */
        }

        .match {
            background: rgba(255, 255, 255, 0.95); /* Sedikit transparan */
            border-radius: 12px; /* Sudut lebih membulat */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2); /* Bayangan lebih kuat */
            margin: 0.8rem 0; /* Sedikit mengurangi margin */
            padding: 1rem; /* Sedikit mengurangi padding */
            width: 100%; /* Match mengisi lebar round */
            max-width: 100%; /* Biarkan match mengisi lebar round */
            transition: all 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); /* Transisi lebih halus */
            position: relative;
            border: 2px solid #FFD700; /* Border emas */
            overflow: hidden; /* Untuk efek kilau */
            box-sizing: border-box;
        }

        .match::before { /* Efek kilau */
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.5), transparent);
            transition: all 0.5s ease;
            transform: skewX(-20deg);
        }

        .match:hover::before {
            left: 100%;
        }

        .match:hover {
            transform: translateY(-8px) scale(1.02); /* Efek hover lebih dramatis */
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
            border-color: #FF0000; /* Border berubah warna saat hover */
        }

        .player {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0.5rem; /* Sedikit mengurangi padding */
            flex-wrap: wrap;
            border-bottom: 1px solid #e2e8f0;
            font-weight: 500;
        }

        .player:last-child {
            border-bottom: none;
        }

        .player.winner {
            font-weight: 700; /* Lebih tebal */
            color: #8B0000; /* Merah gelap */
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1); /* Bayangan teks */
            animation: winner-pulse 1s infinite alternate; /* Animasi pulse untuk pemenang */
        }

        @keyframes winner-pulse {
            0% { transform: scale(1); color: #8B0000; }
            100% { transform: scale(1.03); color: #FF0000; }
        }

        .player-name-select {
            flex-grow: 1;
            margin-right: 0.5rem; /* Sedikit mengurangi margin */
            padding: 0.25rem 0.5rem; /* Sedikit mengurangi padding */
            border: 1px solid #ccc; /* Border lebih jelas */
            border-radius: 6px; /* Lebih membulat */
            background-color: #fefefe;
            font-family: 'Poppins', sans-serif;
            font-size: 0.8rem; /* Ukuran font sedikit lebih kecil */
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 100%;
            min-width: 0;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1); /* Bayangan dalam */
        }

        .score-container {
            display: flex;
            gap: 0.15rem; /* Sedikit mengurangi jarak antar skor */
            align-items: center;
            flex-shrink: 0;
        }

        .score-input-wrapper {
            display: flex;
            align-items: center;
            position: relative;
        }

        .score-input {
            width: 38px; /* Sedikit mengurangi lebar */
            height: 28px; /* Sedikit mengurangi tinggi */
            text-align: center;
            border: 1px solid #bbb;
            border-radius: 6px;
            padding: 0 4px;
            box-sizing: border-box;
            font-size: 0.9rem; /* Sedikit mengurangi ukuran font */
            font-weight: 600;
            -moz-appearance: textfield;
            transition: all 0.2s ease;
        }

        .score-input:focus {
            border-color: #FF0000; /* Border merah saat fokus */
            box-shadow: 0 0 0 2px rgba(255,0,0,0.3);
        }

        .score-input::-webkit-outer-spin-button,
        .score-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        .score-controls {
            display: flex;
            flex-direction: column;
            margin-left: 4px; /* Sedikit mengurangi margin */
        }

        .score-up, .score-down {
            width: 16px; /* Sedikit mengurangi lebar */
            height: 14px; /* Sedikit mengurangi tinggi */
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            border-radius: 3px;
            transition: background-color 0.2s ease;
        }

        .score-up:hover, .score-down:hover {
            background-color: #e0e0e0;
        }

        .score-up svg, .score-down svg {
            width: 9px; /* Sedikit mengurangi ukuran SVG */
            height: 9px; /* Sedikit mengurangi ukuran SVG */
            fill: #333;
        }

        /* Connector styles for bracket lines */
        .qf-sf-connector, .sf-final-connector, .r16-qf-connector {
            position: relative;
            width: 40px; /* Mengurangi lebar konektor */
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            align-items: center;
            flex-shrink: 0; /* Pastikan konektor tidak menyusut */
        }

        .qf-sf-connector .h-line, .sf-final-connector .h-line, .r16-qf-connector .h-line {
            height: 3px; /* Lebih tebal */
            width: 100%;
            background-color: #8B0000; /* Merah gelap */
            position: absolute;
            left: 0;
            box-shadow: 0 0 5px rgba(0,0,0,0.3); /* Bayangan pada garis */
        }

        .qf-sf-connector .v-line, .sf-final-connector .v-line, .r16-qf-connector .v-line {
            width: 3px; /* Lebih tebal */
            background-color: #8B0000; /* Merah gelap */
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 5px rgba(0,0,0,0.3); /* Bayangan pada garis */
        }

        /* Penyesuaian posisi garis agar sesuai dengan ukuran match yang lebih besar */
        /* Menggunakan calc() dengan variabel CSS atau nilai yang lebih adaptif */
        .qf-sf-connector .v-line-top, .r16-qf-connector .v-line-top {
            top: calc(var(--match-padding-top) + var(--match-border-width)); /* Padding match + border */
            height: calc(50% - var(--match-padding-top) - var(--match-border-width) + var(--match-height-adjusted) / 2); /* Setengah tinggi round - padding - border + match padding */
        }

        .qf-sf-connector .v-line-bottom, .r16-qf-connector .v-line-bottom {
            bottom: calc(var(--match-padding-bottom) + var(--match-border-width)); /* Padding match + border */
            height: calc(50% - var(--match-padding-bottom) - var(--match-border-width) + var(--match-height-adjusted) / 2); /* Setengah tinggi round - padding - border + match padding */
        }

        .sf-final-connector .v-line {
            height: calc(100% - 2 * var(--round-padding-vertical) - 2 * var(--round-border-width)); /* Tinggi round - 2*padding - 2*border */
        }

        /* Specific adjustments for mix-doubles R16 to QF connector */
        #mix-doubles-bracket .r16-qf-connector .h-line.top-match {
            top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);
        }

        #mix-doubles-bracket .r16-qf-connector .h-line.bottom-match {
            top: calc(var(--round-padding-top) + 2 * (var(--match-margin-top) + var(--match-height-adjusted) + var(--match-margin-bottom)) + var(--match-margin-top) + var(--match-height-adjusted) / 2);
        }

        .live-indicator {
            position: absolute;
            top: -8px; /* Lebih keluar */
            right: -8px; /* Lebih keluar */
            background-color: #ef4444;
            width: 15px; /* Lebih besar */
            height: 15px; /* Lebih besar */
            border-radius: 50%;
            animation: pulse 1.5s infinite;
            border: 2px solid white; /* Border putih */
            box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.5); /* Bayangan luar */
        }

        @keyframes pulse {
            0% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); }
            70% { transform: scale(1.1); box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); } /* Efek pulse lebih besar */
            100% { transform: scale(0.95); box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); }
        }

        .tournament-title {
            font-family: 'Bebas Neue', sans-serif; /* Font lebih berani */
            font-size: 4.5rem; /* Sangat besar */
            font-weight: 900; /* Sangat tebal */
            margin: 3.5rem auto 2.5rem; /* Auto margin untuk tengah */
            color: #FF0000; /* Merah gelap */
            text-shadow: 5px 5px 10px rgba(0,0,0,0.5), 0 0 15px #FFD700; /* Bayangan lebih kuat + kilau emas */
            letter-spacing: 4px; /* Spasi antar huruf lebih lebar */
            line-height: 1.1; /* Jarak antar baris */
            position: relative;
            z-index: 2;
            animation: title-pop 1.2s ease-out forwards, title-glow 3.5s infinite alternate; /* Animasi muncul + glow lebih panjang */
            text-align: center; /* Pastikan teks di tengah */
            width: fit-content; /* Agar auto margin bekerja */
        }

        @keyframes title-pop {
            0% { opacity: 0; transform: translateY(-60px) scale(0.7); } /* Mulai lebih tinggi, lebih kecil */
            100% { opacity: 1; transform: translateY(0px) scale(1); }
        }

        @keyframes title-glow {
            0% { text-shadow: 5px 5px 10px rgba(0,0,0,0.5), 0 0 15px #FFD700; }
            100% { text-shadow: 5px 5px 10px rgba(0,0,0,0.5), 0 0 25px #FFD700, 0 0 40px rgba(255,0,0,0.6); } /* Glow lebih kuat + merah */
        }

        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem; /* Margin lebih besar */
            position: relative;
            z-index: 2;
            background: rgba(255, 255, 255, 0.2); /* Latar belakang transparan */
            border-radius: 10px;
            padding: 0.5rem;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .tab {
            padding: 0.75rem 1.5rem; /* Padding lebih besar */
            cursor: pointer;
            border-bottom: 3px solid transparent; /* Border lebih tebal */
            font-weight: 600;
            color: #333;
            transition: all 0.3s ease;
            text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
        }

        .tab:hover {
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 8px;
        }

        .tab.active {
            border-bottom: 3px solid #8B0000; /* Border merah gelap */
            color: #8B0000; /* Teks merah gelap */
            font-weight: 700;
            background-color: rgba(255, 255, 255, 0.4);
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .hidden {
            display: none;
        }

        .live-scoreboard {
            position: fixed;
            bottom: 20px; /* Sedikit lebih tinggi */
            right: 20px; /* Sedikit lebih ke dalam */
            background: rgba(255, 255, 255, 0.98); /* Hampir solid */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.3); /* Bayangan lebih kuat */
            border-radius: 15px; /* Lebih membulat */
            padding: 1.2rem; /* Sedikit mengurangi padding */
            max-width: 320px; /* Sedikit mengurangi lebar */
            z-index: 100;
            border: 2px solid #FFD700; /* Border emas */
            animation: slide-in 0.5s ease-out forwards; /* Animasi slide-in */
        }

        @keyframes slide-in {
            0% { transform: translateX(100%); opacity: 0; }
            100% { transform: translateX(0); opacity: 1; }
        }

        .live-scoreboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.8rem; /* Sedikit mengurangi margin */
            padding-bottom: 0.4rem; /* Sedikit mengurangi padding */
            border-bottom: 1px solid #eee;
        }

        .live-scoreboard-header h3 {
            color: #8B0000; /* Merah gelap */
            font-weight: 700;
            font-size: 1.1rem; /* Sedikit mengurangi ukuran font */
        }

        .live-scoreboard .player {
            padding: 0.4rem 0; /* Sedikit mengurangi padding */
            font-size: 1rem; /* Sedikit mengurangi ukuran font */
            font-weight: 600;
        }

        #progress-bar {
            background-color: #8B0000; /* Merah gelap */
            box-shadow: 0 0 5px rgba(255,0,0,0.5); /* Bayangan pada progress bar */
        }

        /* Gaya untuk tombol login/logout dan status admin */
        .auth-controls {
            position: fixed;
            top: 15px; /* Sedikit lebih dekat ke atas */
            right: 15px; /* Sedikit lebih dekat ke kanan */
            z-index: 1000;
            display: flex;
            gap: 8px; /* Sedikit mengurangi gap */
            align-items: center;
            flex-wrap: wrap; /* Tambahkan ini untuk responsivitas */
            justify-content: flex-end; /* Tambahkan ini untuk responsivitas */
        }
        .auth-controls button {
            background-color: #8B0000;
            color: white;
            padding: 7px 12px; /* Sedikit mengurangi padding */
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;
            white-space: nowrap; /* Mencegah teks tombol pecah */
        }
        .auth-controls button:hover {
            background-color: #FF0000;
        }
        .auth-controls input {
            background-color: rgba(255, 255, 255, 0.9);
            border: 1px solid #ccc;
            padding: 7px 10px; /* Sedikit mengurangi padding */
            border-radius: 8px;
            font-size: 0.85rem; /* Sedikit mengurangi ukuran font */
            color: #333;
        }
        .admin-status {
            font-weight: 600;
            color: #8B0000;
            background-color: rgba(255, 255, 255, 0.8);
            padding: 4px 8px; /* Sedikit mengurangi padding */
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            white-space: nowrap;
        }

        /* --- Mobile Optimizations --- */
        @media (max-width: 768px) {
            body {
                background-attachment: scroll; /* Nonaktifkan fixed background di mobile */
                background-size: auto 100%; /* Sesuaikan ukuran gambar untuk mobile */
            }

            .background-particles {
                display: none; /* Sembunyikan partikel di mobile untuk performa */
            }
            .firework {
                display: none; /* Sembunyikan kembang api di mobile */
            }

            .umbul-umbul-container {
                height: 120px; /* Adjust for mobile */
                padding-top: 10px;
            }
            .umbul-umbul {
                border-left: 25px solid transparent;
                border-right: 25px solid transparent;
                border-bottom: 70px solid;
                margin: 0 3px;
            }
            /* Adjust diagonal for mobile */
            .umbul-umbul:nth-child(odd) {
                transform: rotate(-12deg) translateY(0px);
                margin-left: -15px;
            }
            .umbul-umbul:nth-child(even) {
                transform: rotate(12deg) translateY(0px);
                margin-right: -15px;
            }
            @keyframes sway {
                0% { transform: rotate(-12deg) translateY(0px); }
                50% { transform: rotate(-15deg) translateY(-4px); }
                100% { transform: rotate(-9deg) translateY(0px); }
            }
            @keyframes sway-even {
                0% { transform: rotate(12deg) translateY(0px); }
                50% { transform: rotate(15deg) translateY(-4px); }
                100% { transform: rotate(9deg) translateY(0px); }
            }


            .flag-ornament {
                width: 50px;
                height: 30px;
                border: 2px solid #8B0000;
                box-shadow: 0 3px 6px rgba(0,0,0,0.25);
            }
            .flag-ornament.top-left { top: 15px; left: 15px; }
            .flag-ornament.top-right { top: 15px; right: 15px; }
            .flag-ornament.bottom-left { bottom: 15px; left: 15px; }
            .flag-ornament.bottom-right { bottom: 15px; right: 15px; }

            .hero-silhouette {
                width: 250px;
                height: 180px;
                opacity: 0.1;
            }
            .ribbon {
                top: 90px;
                height: 25px;
                width: 95%;
            }

            .bracket {
                flex-direction: column;
                padding: 1rem;
                align-items: stretch;
                gap: 1rem;
            }

            .round {
                margin: 0.5rem 0;
                min-height: auto;
                width: 100%;
                padding: 0.8rem;
                max-width: none; /* Hapus batasan lebar di mobile */
            }

            .match {
                width: 98%;
                margin-left: auto;
                margin-right: auto;
                padding: 1rem;
                border-radius: 10px;
                border: 1px solid #FFD700;
                max-width: none; /* Hapus batasan lebar di mobile */
            }

            .match:hover {
                transform: translateY(-4px) scale(1.01);
                box-shadow: 0 8px 16px rgba(0, 0, 0, 0.25);
            }

            .qf-sf-connector,
            .sf-final-connector,
            .r16-qf-connector { /* Sembunyikan konektor di mobile */
                display: none;
            }

            .player-name-select {
                font-size: 0.8rem;
                padding: 0.2rem 0.4rem;
            }

            .score-input {
                width: 35px;
                height: 28px;
                font-size: 0.9rem;
            }

            .live-scoreboard {
                max-width: 90%;
                left: 50%;
                transform: translateX(-50%);
                bottom: 10px;
                right: auto;
                padding: 1rem;
                border-radius: 10px;
                border: 1px solid #FFD700;
            }

            .tabs {
                flex-wrap: wrap;
                justify-content: space-around;
                padding: 0.3rem;
                margin-bottom: 1rem;
            }

            .tab {
                flex: 1 1 auto;
                text-align: center;
                margin: 0.1rem;
                padding: 0.6rem 0.4rem;
                font-size: 0.9rem;
            }

            .tournament-title {
                font-size: 2.5rem;
                margin: 1.8rem auto 1.2rem; /* Auto margin untuk tengah */
                letter-spacing: 2px;
            }

            .auth-controls {
                top: 10px;
                right: 10px;
                flex-direction: column;
                align-items: flex-end;
                gap: 5px; /* Kurangi jarak antar elemen */
            }
            .auth-controls button {
                padding: 5px 10px;
                font-size: 0.8rem;
            }
            .auth-controls input {
                width: 100%; /* Penuh lebar */
                box-sizing: border-box; /* Pastikan padding tidak menambah lebar */
                margin-bottom: 5px; /* Jarak antar input */
            }
            .admin-status {
                font-size: 0.7rem;
                padding: 3px 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Efek Partikel Latar Belakang (Konfeti) -->
    <div class="background-particles"></div>

    <!-- Ornamen Umbul-umbul -->
    <div class="umbul-umbul-container">
        <div class="umbul-umbul red"></div>
        <div class="umbul-umbul white"></div>
        <div class="umbul-umbul red"></div>
        <div class="umbul-umbul white"></div>
        <div class="umbul-umbul red"></div>
        <div class="umbul-umbul white"></div>
        <div class="umbul-umbul red"></div>
        <div class="umbul-umbul white"></div>
        <div class="umbul-umbul red"></div>
        <div class="umbul-umbul white"></div>
        <div class="umbul-umbul red"></div>
        <div class="umbul-umbul white"></div>
        <div class="umbul-umbul red"></div>
        <div class="umbul-umbul white"></div>
        <div class="umbul-umbul red"></div>
    </div>

    <!-- Ornamen Bendera Kecil di Sudut -->
    <div class="flag-ornament top-left"></div>
    <div class="flag-ornament top-right"></div>
    <div class="flag-ornament bottom-left"></div>
    <div class="flag-ornament bottom-right"></div>

    <!-- Siluet Pahlawan / Monumen (Contoh: Monas) -->
    <div class="hero-silhouette"></div>

    <!-- Pita Merah Putih -->
    <div class="ribbon"></div>

    <h1 class="tournament-title">Effrensindo Badminton Tournament<br>Dirgahayu Kemerdekaan Indonesia ke-80!</h1>

    <!-- Kontrol Autentikasi -->
    <div class="auth-controls">
        <span id="admin-status" class="admin-status hidden"></span>
        <button id="toggle-email-auth" onclick="toggleEmailAuth()">Login</button>
        <button id="logout-button" onclick="signOutUser()" class="hidden">Logout</button>

        <div id="email-password-auth" class="hidden flex flex-col items-end gap-2 mt-2 w-full">
            <input type="email" id="email-input" placeholder="Email" class="p-2 border rounded-md w-full">
            <input type="password" id="password-input" placeholder="Password" class="p-2 border rounded-md w-full">
            <div class="flex gap-2 w-full justify-end">
                <!-- Tombol Sign Up dihapus -->
                <button id="signin-email-button" onclick="signInWithEmailPassword()" class="bg-green-600 hover:bg-green-700 text-white p-2 rounded-md">Sign In</button>
            </div>
        </div>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="changeTab('singles')">Men's Singles</div>
        <div class="tab" onclick="changeTab('doubles')">Men's Doubles</div>
        <div class="tab" onclick="changeTab('mix-doubles')">Mix Doubles</div>
    </div>

    <div id="singles-bracket" class="bracket">
        <!-- Quarter Finals -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Quarter Finals</h3>
            <div class="match" data-match-id="singles-qf1" onclick="toggleLiveScore('singles-qf1')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="singles-qf2" onclick="toggleLiveScore('singles-qf2')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="singles-qf3" onclick="toggleLiveScore('singles-qf3')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="singles-qf4" onclick="toggleLiveScore('singles-qf4')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector Quarter Finals to Semi Finals -->
        <div class="qf-sf-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="h-line" style="top: calc(var(--round-padding-top) + 2 * (var(--match-margin-top) + var(--match-height-adjusted) + var(--match-margin-bottom)) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line v-line-top" style="top: calc(var(--round-padding-top) + var(--match-margin-top));"></div>
            <div class="v-line v-line-bottom" style="bottom: calc(var(--round-padding-bottom) + var(--match-margin-bottom));"></div>
        </div>

        <!-- Semi Finals -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Semi Finals</h3>
            <div class="match" data-match-id="singles-sf1" onclick="toggleLiveScore('singles-sf1')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="singles-sf2" onclick="toggleLiveScore('singles-sf2')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector Semi Finals to Final -->
        <div class="sf-final-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top)); height: calc(var(--round-height) - 2 * var(--round-padding-top) - 2 * var(--match-margin-top));"></div>
        </div>

        <!-- NEW: 3rd Place Match for Singles -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">3rd Place Match</h3>
            <div class="match" data-match-id="singles-3rd-place" onclick="toggleLiveScore('singles-3rd-place')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector 3rd Place to Final (Optional, but good for visual flow) -->
        <div class="sf-final-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top)); height: calc(var(--round-height) - 2 * var(--round-padding-top) - 2 * var(--match-margin-top));"></div>
        </div>

        <!-- Final -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Final</h3>
            <div class="match" data-match-id="singles-final" onclick="toggleLiveScore('singles-final')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="doubles-bracket" class="bracket hidden">
        <!-- Quarter Finals -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Quarter Finals</h3>
            <div class="match" data-match-id="doubles-qf1" onclick="toggleLiveScore('doubles-qf1')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="doubles-qf2" onclick="toggleLiveScore('doubles-qf2')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="doubles-qf3" onclick="toggleLiveScore('doubles-qf3')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="doubles-qf4" onclick="toggleLiveScore('doubles-qf4')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector Quarter Finals to Semi Finals -->
        <div class="qf-sf-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="h-line" style="top: calc(var(--round-padding-top) + 2 * (var(--match-margin-top) + var(--match-height-adjusted) + var(--match-margin-bottom)) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line v-line-top" style="top: calc(var(--round-padding-top) + var(--match-margin-top));"></div>
            <div class="v-line v-line-bottom" style="bottom: calc(var(--round-padding-bottom) + var(--match-margin-bottom));"></div>
        </div>

        <!-- Semi Finals -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Semi Finals</h3>
            <div class="match" data-match-id="doubles-sf1" onclick="toggleLiveScore('doubles-sf1')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="doubles-sf2" onclick="toggleLiveScore('doubles-sf2')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector Semi Finals to Final -->
        <div class="sf-final-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top)); height: calc(var(--round-height) - 2 * var(--round-padding-top) - 2 * var(--match-margin-top));"></div>
        </div>

        <!-- NEW: 3rd Place Match for Doubles -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">3rd Place Match</h3>
            <div class="match" data-match-id="doubles-3rd-place" onclick="toggleLiveScore('doubles-3rd-place')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector 3rd Place to Final (Optional, but good for visual flow) -->
        <div class="sf-final-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top)); height: calc(var(--round-height) - 2 * var(--round-padding-top) - 2 * var(--match-margin-top));"></div>
        </div>

        <!-- Final -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Final</h3>
            <div class="match" data-match-id="doubles-final" onclick="toggleLiveScore('doubles-final')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="mix-doubles-bracket" class="bracket hidden">
        <!-- Round of 16 (First Round for 11 players) -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Round of 16</h3>
            <!-- Match 1 -->
            <div class="match" data-match-id="mix-doubles-r16-1" onclick="toggleLiveScore('mix-doubles-r16-1')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Match 2 -->
            <div class="match" data-match-id="mix-doubles-r16-2" onclick="toggleLiveScore('mix-doubles-r16-2')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Match 3 -->
            <div class="match" data-match-id="mix-doubles-r16-3" onclick="toggleLiveScore('mix-doubles-r16-3')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Placeholder for Bye 1 -->
            <div class="match" data-match-id="mix-doubles-r16-bye1" style="visibility: hidden; margin: 0.8rem 0;"></div>
            <!-- Placeholder for Bye 2 -->
            <div class="match" data-match-id="mix-doubles-r16-bye2" style="visibility: hidden; margin: 0.8rem 0;"></div>
        </div>

        <!-- Connector Round of 16 to Quarter Finals -->
        <div class="r16-qf-connector">
            <!-- Horizontal lines connecting to QF matches -->
            <div class="h-line top-match"></div>
            <div class="h-line bottom-match"></div>
            <!-- Vertical lines connecting to R16 matches -->
            <div class="v-line v-line-top" style="top: calc(var(--round-padding-top) + var(--match-margin-top));"></div>
            <div class="v-line v-line-bottom" style="bottom: calc(var(--round-padding-bottom) + var(--match-margin-bottom));"></div>
        </div>

        <!-- Quarter Finals -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Quarter Finals</h3>
            <div class="match" data-match-id="mix-doubles-qf1" onclick="toggleLiveScore('mix-doubles-qf1')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="mix-doubles-qf2" onclick="toggleLiveScore('mix-doubles-qf2')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="mix-doubles-qf3" onclick="toggleLiveScore('mix-doubles-qf3')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="match" data-match-id="mix-doubles-qf4" onclick="toggleLiveScore('mix-doubles-qf4')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector Quarter Finals to Semi Finals -->
        <div class="qf-sf-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="h-line" style="top: calc(var(--round-padding-top) + 2 * (var(--match-margin-top) + var(--match-height-adjusted) + var(--match-margin-bottom)) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line v-line-top" style="top: calc(var(--round-padding-top) + var(--match-margin-top));"></div>
            <div class="v-line v-line-bottom" style="bottom: calc(var(--round-padding-bottom) + var(--match-margin-bottom));"></div>
        </div>

        <!-- Semi Finals -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Semi Finals</h3>
            <div class="match" data-match-id="mix-doubles-sf1" onclick="toggleLiveScore('mix-doubles-sf1')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- NEW: Mix Doubles Semi Final 2 -->
            <div class="match" data-match-id="mix-doubles-sf2" onclick="toggleLiveScore('mix-doubles-sf2')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector Semi Finals to 3rd Place -->
        <div class="sf-final-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top)); height: calc(var(--round-height) - 2 * var(--round-padding-top) - 2 * var(--match-margin-top));"></div>
        </div>

        <!-- NEW: 3rd Place Match -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">3rd Place Match</h3>
            <div class="match" data-match-id="mix-doubles-3rd-place" onclick="toggleLiveScore('mix-doubles-3rd-place')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Connector 3rd Place to Final (Optional, but good for visual flow) -->
        <div class="sf-final-connector">
            <div class="h-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top) + var(--match-height-adjusted) / 2);"></div>
            <div class="v-line" style="top: calc(var(--round-padding-top) + var(--match-margin-top)); height: calc(var(--round-height) - 2 * var(--round-padding-top) - 2 * var(--match-margin-top));"></div>
        </div>

        <!-- Final -->
        <div class="round">
            <h3 class="text-center font-semibold mb-4">Final</h3>
            <div class="match" data-match-id="mix-doubles-final" onclick="toggleLiveScore('mix-doubles-final')">
                <div class="player" data-player="1">
                    <select class="player-name-select" data-player-select="1" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="1">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="player" data-player="2">
                    <select class="player-name-select" data-player-select="2" disabled></select>
                    <div class="score-container">
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="1" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="1" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="2" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="2" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="score-input-wrapper">
                            <input type="number" class="score-input" value="0" min="0" max="30" data-set="3" disabled>
                            <div class="score-controls">
                                <div class="score-up" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 14l5-5 5 5z"/></svg>
                                </div>
                                <div class="score-down" data-set="3" data-player="2">
                                    <svg viewBox="0 0 24 24"><path d="M7 10l5 5 5-5z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="live-scoreboard" class="live-scoreboard hidden">
        <div class="live-scoreboard-header">
            <h3 class="font-semibold">Live Match</h3>
            <button onclick="closeLiveScore()" class="text-gray-500 hover:text-gray-700"></button>
        </div>
        <div id="live-match-content">
            <div class="player flex justify-between items-center mb-2">
                <div class="flex items-center">
                    <span id="live-player-1">Player 1</span>
                </div>
                <div class="flex gap-2" id="live-scores-1"></div>
            </div>
            <div class="player flex justify-between items-center">
                <div class="flex items-center">
                    <span id="live-player-2">Player 2</span>
                </div>
                <div class="flex gap-2" id="live-scores-2"></div>
            </div>
            <div class="progress-bar-container mt-3 bg-gray-200 rounded-full h-2.5">
                <div id="progress-bar" class="bg-blue-500 h-2.5 rounded-full" style="width: 0%"></div>
            </div>
            <div class="flex justify-between mt-1 text-sm">
                <span id="current-set">Set 1</span>
                <span id="match-status">Playing</span>
            </div>
        </div>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.0/firebase-firestore-compat.js"></script>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCgXWrv-yNSGV1cCzMghgNksY1XNHAfl38",
            authDomain: "badmintonefk.firebaseapp.com",
            projectId: "badmintonefk",
            storageBucket: "badmintonefk.firebasestorage.app",
            messagingSenderId: "987525154148",
            appId: "1:987525154148:web:faba3301c884e9cf6a2671"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth(); // Inisialisasi Firebase Auth

        // Global variables
        let currentTab = 'singles';
        let liveMatchId = null;
        let matchInterval = null;
        let currentSet = 1;
        let player1Score = 0;
        let player2Score = 0;

        // Daftar pemain yang tersedia
        const allPlayers = [
            "BINTANG", "DAYAT", "HUSNI", "QOSIM", "EDWIN", "ANDI S", "FADIL", "RAKA"
        ];

        // Initial player assignments for each bracket type
        const initialPlayerAssignments = {
            'singles': {
                'qf1': ['BINTANG', 'DAYAT'],
                'qf2': ['HUSNI', 'QOSIM'],
                'qf3': ['EDWIN', 'ANDI S'],
                'qf4': ['FADIL', 'RAKA']
            },
            'doubles': {
                'qf1': ['RAKA & FADIL ', 'PUTRA & HARYO'],
                'qf2': ['EDWIN & WAHYU YIB', 'RANGGA & ANDI S'],
                'qf3': ['ANDY R & GALIH', 'BRIAN & DAYAT'],
                'qf4': ['QOSIM & WAHYU A', 'HUSNI & BINTANG']
            },
            'mix-doubles': {
                'r16-1': ['ANDI S & MAIDA', 'WAHYU A & ANISA'],
                'r16-2': ['FADIL & ANGGI', 'BINTANG & WINDA'],
                'r16-3': ['RENI & PUTRA', 'DAYAT & TANIA'],
                'all-mix-players': [
                    'ANDI S & MAIDA', 'WAHYU A & ANISA',
                    'FADIL & ANGGI', 'BINTANG & WINDA',
                    'RENI & PUTRA', 'DAYAT & TANIA',
                    'HUSNI & TUTI', 'GALIH & MARIA', 'ANDY R & ROSSIANA', 'EDWIN & ARIFA', 'RAKA & KARTIKA'
                ]
            }
        };

        // --- Variabel dan Fungsi Baru untuk Admin ---
        let isAdmin = false;
        const adminUidsRef = db.collection('config').doc('adminUids'); // Dokumen untuk menyimpan UID admin
        let unsubscribeLiveMatchListener = null; // Variabel global untuk menyimpan unsubscribe function dari listener Firestore

        // Fungsi untuk mengaktifkan/menonaktifkan input
        function setInputsDisabled(disabled) {
            document.querySelectorAll('.score-input').forEach(input => {
                input.disabled = disabled;
            });
            document.querySelectorAll('.player-name-select').forEach(select => {
                select.disabled = disabled;
            });
            // Also disable/enable score controls
            document.querySelectorAll('.score-up, .score-down').forEach(control => {
                if (disabled) {
                    control.style.pointerEvents = 'none';
                    control.style.opacity = '0.5';
                } else {
                    control.style.pointerEvents = 'auto';
                    control.style.opacity = '1';
                }
            });
        }

        // Fungsi untuk login dengan Email/Password
        async function signInWithEmailPassword() {
            const email = document.getElementById('email-input').value;
            const password = document.getElementById('password-input').value;

            if (!email || !password) {
                alert("Please enter both email and password.");
                return;
            }

            try {
                await auth.signInWithEmailAndPassword(email, password);
                console.log("User signed in with email/password.");
                alert("Login successful!");
                document.getElementById('email-password-auth').classList.add('hidden');
            } catch (error) {
                console.error("Error signing in with email/password:", error);
                alert("Login failed: " + error.message);
            }
        }

        // Fungsi untuk logout
        async function signOutUser() {
            try {
                await auth.signOut();
                console.log("User signed out.");
            } catch (error) {
                console.error("Error signing out:", error);
                alert("Logout failed: " + error.message);
            }
        }

        // Fungsi untuk menampilkan/menyembunyikan form email/password
        function toggleEmailAuth() {
            const emailAuthDiv = document.getElementById('email-password-auth');
            emailAuthDiv.classList.toggle('hidden');
        }

        // Listener untuk perubahan status autentikasi
        auth.onAuthStateChanged(async (user) => {
            const toggleEmailAuthButton = document.getElementById('toggle-email-auth');
            const logoutButton = document.getElementById('logout-button');
            const adminStatusSpan = document.getElementById('admin-status');

            if (user) {
                // User is signed in.
                toggleEmailAuthButton.classList.add('hidden');
                logoutButton.classList.remove('hidden');
                adminStatusSpan.classList.remove('hidden');
                adminStatusSpan.textContent = `Logged in as: ${user.displayName || user.email}`;

                // Periksa apakah user adalah admin
                const adminDoc = await adminUidsRef.get();
                if (adminDoc.exists && adminDoc.data().uids.includes(user.uid)) {
                    isAdmin = true;
                    adminStatusSpan.textContent += " (Admin)";
                    setInputsDisabled(false); // Aktifkan input untuk admin
                    console.log("User is an admin.");
                } else {
                    isAdmin = false;
                    adminStatusSpan.textContent += " (View Only)";
                    setInputsDisabled(true); // Nonaktifkan input untuk non-admin
                    console.log("User is not an admin (view only).");
                }
            } else {
                // User is signed out.
                isAdmin = false;
                toggleEmailAuthButton.classList.remove('hidden');
                logoutButton.classList.add('hidden');
                adminStatusSpan.classList.add('hidden');
                adminStatusSpan.textContent = "";
                setInputsDisabled(true); // Nonaktifkan input saat tidak login
                console.log("User is signed out (view only).");
            }
        });

        // Modifikasi fungsi saveData agar hanya admin yang bisa menyimpan
        async function saveData() {
            if (!isAdmin) {
                console.warn("Save operation denied: Not an admin.");
                return; // Hentikan jika bukan admin
            }
            console.log("Attempting to save data...");
            const allBracketData = {};
            document.querySelectorAll('.bracket').forEach(bracketElement => {
                const bracketId = bracketElement.id;
                const matchesData = {};
                bracketElement.querySelectorAll('.match').forEach(match => {
                    const matchId = match.getAttribute('data-match-id');
                    const player1Select = match.querySelector('.player[data-player="1"] .player-name-select');
                    const player2Select = match.querySelector('.player[data-player="2"] .player-name-select');

                    if (!player1Select || !player2Select) {
                        matchesData[matchId] = {
                            isPlaceholder: true
                        };
                        return;
                    }

                    const p1Scores = Array.from(match.querySelectorAll('.player[data-player="1"] .score-input')).map(input => parseInt(input.value));
                    const p2Scores = Array.from(match.querySelectorAll('.player[data-player="2"] .score-input')).map(input => parseInt(input.value));
                    const isWinner1 = player1Select.closest('.player').classList.contains('winner');
                    const isWinner2 = player2Select.closest('.player').classList.contains('winner');

                    const matchDataset = JSON.parse(match.dataset.matchData || '{}');
                    const setWinners = matchDataset.setWinners || [];
                    const matchWinner = matchDataset.matchWinner || null; // Tambahkan matchWinner

                    matchesData[matchId] = {
                        player1: player1Select.value,
                        player2: player2Select.value,
                        scores1: p1Scores,
                        scores2: p2Scores,
                        isWinner1: isWinner1,
                        isWinner2: isWinner2,
                        setWinners: setWinners,
                        matchWinner: matchWinner // Simpan matchWinner
                    };
                });
                allBracketData[bracketId] = matchesData;
            });

            console.log("Data to be saved:", allBracketData);

            try {
                await db.collection('tournamentData').doc('currentBracket').set(allBracketData);

                // Simpan juga liveMatchId saat ini
                await db.collection('config').doc('liveMatch').set({
                    liveMatchId: liveMatchId, // liveMatchId adalah variabel global yang sudah ada
                    timestamp: firebase.firestore.FieldValue.serverTimestamp() // Opsional: untuk melacak kapan diupdate
                });

                console.log("Data successfully written to Firestore!");
            }
            catch (error) {
                console.error("Error writing document to Firestore: ", error);
            }
        }

        // Function to load all bracket data from Firestore
        async function loadData() {
            console.log("Attempting to load data from Firestore...");
            try {
                const doc = await db.collection('tournamentData').doc('currentBracket').get();
                if (doc.exists) {
                    const allBracketData = doc.data();
                    console.log("Data successfully loaded from Firestore:", allBracketData);
                    updateUIFromFirestoreSnapshot(allBracketData); // Panggil fungsi untuk update UI
                } else {
                    console.log("No 'currentBracket' document found in 'tournamentData' collection. Saving initial data.");
                    await saveData(); // Save initial data if document doesn't exist
                }
            } catch (error) {
                console.error("Error getting document from Firestore: ", error);
            }
        }

        // Fungsi untuk memperbarui UI dari snapshot Firestore
        function updateUIFromFirestoreSnapshot(allBracketData) {
            for (const bracketId in allBracketData) {
                const bracketElement = document.getElementById(bracketId);
                if (!bracketElement) continue;

                const matchesData = allBracketData[bracketId];
                for (const matchId in matchesData) {
                    const match = bracketElement.querySelector(`.match[data-match-id="${matchId}"]`);
                    if (!match || matchesData[matchId].isPlaceholder) continue;

                    const data = matchesData[matchId];
                    const player1Select = match.querySelector('.player[data-player="1"] .player-name-select');
                    const player2Select = match.querySelector('.player[data-player="2"] .player-name-select');
                    const p1ScoreInputs = match.querySelectorAll('.player[data-player="1"] .score-input');
                    const p2ScoreInputs = match.querySelectorAll('.player[data-player="2"] .score-input');
                    const player1Div = match.querySelector('.player[data-player="1"]');
                    const player2Div = match.querySelector('.player[data-player="2"]');

                    // Update dropdown values (hanya jika berbeda untuk menghindari reset fokus admin)
                    if (player1Select) { // Tambahkan cek null
                        if (data.player1 && player1Select.value !== data.player1) {
                            // Tambahkan opsi jika belum ada
                            if (!Array.from(player1Select.options).some(opt => opt.value === data.player1)) {
                                const newOption = document.createElement('option');
                                newOption.value = data.player1;
                                newOption.textContent = data.player1;
                                player1Select.appendChild(newOption);
                            }
                            player1Select.value = data.player1;
                        } else if (!data.player1) { // Jika data.player1 null/kosong, reset select
                            player1Select.value = '';
                        }
                    }
                    if (player2Select) { // Tambahkan cek null
                        if (data.player2 && player2Select.value !== data.player2) {
                            // Tambahkan opsi jika belum ada
                            if (!Array.from(player2Select.options).some(opt => opt.value === data.player2)) {
                                const newOption = document.createElement('option');
                                newOption.value = data.player2;
                                newOption.textContent = data.player2;
                                player2Select.appendChild(newOption);
                            }
                            player2Select.value = data.player2;
                        } else if (!data.player2) { // Jika data.player2 null/kosong, reset select
                            player2Select.value = '';
                        }
                    }


                    // Update scores
                    p1ScoreInputs.forEach((input, i) => {
                        if (data.scores1 && data.scores1[i] !== undefined && parseInt(input.value) !== data.scores1[i]) {
                            input.value = data.scores1[i];
                        }
                    });
                    p2ScoreInputs.forEach((input, i) => {
                        if (data.scores2 && data.scores2[i] !== undefined && parseInt(input.value) !== data.scores2[i]) {
                            input.value = data.scores2[i];
                        }
                    });

                    // Update winner class
                    if (player1Div) {
                        if (data.isWinner1) player1Div.classList.add('winner');
                        else player1Div.classList.remove('winner');
                    }
                    if (player2Div) {
                        if (data.isWinner2) player2Div.classList.add('winner');
                        else player2Div.classList.remove('winner');
                    }

                    // Update dataset for setWinners and matchWinner
                    match.dataset.matchData = JSON.stringify({
                        setWinners: data.setWinners || [],
                        matchWinner: data.matchWinner || null // Load matchWinner
                    });

                    // Jika pertandingan ini adalah pertandingan live saat ini, perbarui scoreboard live
                    if (matchId === liveMatchId) {
                        updateLiveScoreboard(match);
                    }
                }
            }
        }


        // Modifikasi initTournament untuk memanggil setInputsDisabled di awal
        async function initTournament() {
            console.log("Initializing tournament...");
            // Nonaktifkan semua input secara default saat inisialisasi
            setInputsDisabled(true);

            document.querySelectorAll('.score-input').forEach(input => {
                input.addEventListener('change', updateWinner);
                input.addEventListener('input', updateLiveScoreboardOnInput);
                input.addEventListener('change', saveData);
            });

            // Add event listeners for score controls
            document.querySelectorAll('.score-up').forEach(button => {
                button.addEventListener('click', (event) => {
                    const input = event.target.closest('.score-input-wrapper').querySelector('.score-input');
                    if (!input.disabled) { // Only allow if input is not disabled
                        let currentValue = parseInt(input.value);
                        if (currentValue < 30) {
                            input.value = currentValue + 1;
                            input.dispatchEvent(new Event('change')); // Trigger change to update winner/save data
                        }
                    }
                });
            });

            document.querySelectorAll('.score-down').forEach(button => {
                button.addEventListener('click', (event) => {
                    const input = event.target.closest('.score-input-wrapper').querySelector('.score-input');
                    if (!input.disabled) { // Only allow if input is not disabled
                        let currentValue = parseInt(input.value);
                        if (currentValue > 0) {
                            input.value = currentValue - 1;
                            input.dispatchEvent(new Event('change')); // Trigger change to update winner/save data
                        }
                    }
                });
            });

            document.querySelectorAll('.player-name-select').forEach(select => {
                select.addEventListener('change', updateLiveScoreboardOnInput);
                select.addEventListener('change', saveData);
            });

            populateAllPlayerDropdowns();
            await loadData(); // Pastikan data bracket dimuat terlebih dahulu

            // Tambahkan listener untuk liveMatchId
            setupLiveMatchListener();

            // Tambahkan listener untuk perubahan data bracket secara realtime
            db.collection('tournamentData').doc('currentBracket')
                .onSnapshot((doc) => {
                    if (doc.exists) {
                        const allBracketData = doc.data();
                        updateUIFromFirestoreSnapshot(allBracketData);
                        // Setelah UI diperbarui, jalankan logika untuk meneruskan pemenang
                        // Ini penting agar perubahan dari Firestore juga memicu update bracket
                        processBracketWinners();
                    }
                }, (error) => {
                    console.error("Error listening to currentBracket document:", error);
                });


            const savedTab = localStorage.getItem('currentTab');
            if (savedTab) {
                changeTab(savedTab);
                console.log(`Switched to saved tab: ${savedTab}`);
            } else {
                changeTab('singles');
                console.log("No saved tab found, defaulting to singles.");
            }
            console.log("Tournament initialization complete.");

            setMatchHeightCssVariables(); // Panggil fungsi yang diperbarui
            window.addEventListener('resize', setMatchHeightCssVariables);

            createParticles(80); // Lebih banyak partikel
            setInterval(createFirework, 3000); // Kembang api lebih sering
        }

        // Function to dynamically set CSS variables for match and round dimensions
        function setMatchHeightCssVariables() {
            const sampleMatch = document.querySelector('.match');
            const sampleRound = document.querySelector('.round');

            if (sampleMatch && sampleRound) {
                const matchStyle = getComputedStyle(sampleMatch);
                const roundStyle = getComputedStyle(sampleRound);

                const matchHeight = sampleMatch.offsetHeight;
                const matchPaddingTop = parseFloat(matchStyle.paddingTop);
                const matchPaddingBottom = parseFloat(matchStyle.paddingBottom);
                const matchBorderWidth = parseFloat(matchStyle.borderTopWidth); // Assuming all borders are same
                const matchMarginTop = parseFloat(matchStyle.marginTop);
                const matchMarginBottom = parseFloat(matchStyle.marginBottom);

                const roundHeight = sampleRound.offsetHeight;
                const roundPaddingTop = parseFloat(roundStyle.paddingTop);
                const roundPaddingBottom = parseFloat(roundStyle.paddingBottom);
                const roundBorderWidth = parseFloat(roundStyle.borderTopWidth); // Assuming all borders are same

                // Calculate adjusted match height (content + padding + border)
                const matchHeightAdjusted = matchHeight - matchPaddingTop - matchPaddingBottom - (2 * matchBorderWidth);

                document.documentElement.style.setProperty('--match-height', `${matchHeight}px`);
                document.documentElement.style.setProperty('--match-height-adjusted', `${matchHeightAdjusted}px`);
                document.documentElement.style.setProperty('--match-padding-top', `${matchPaddingTop}px`);
                document.documentElement.style.setProperty('--match-padding-bottom', `${matchPaddingBottom}px`);
                document.documentElement.style.setProperty('--match-border-width', `${matchBorderWidth}px`);
                document.documentElement.style.setProperty('--match-margin-top', `${matchMarginTop}px`);
                document.documentElement.style.setProperty('--match-margin-bottom', `${matchMarginBottom}px`);

                document.documentElement.style.setProperty('--round-height', `${roundHeight}px`);
                document.documentElement.style.setProperty('--round-padding-top', `${roundPaddingTop}px`);
                document.documentElement.style.setProperty('--round-padding-bottom', `${roundPaddingBottom}px`);
                document.documentElement.style.setProperty('--round-border-width', `${roundBorderWidth}px`);

                console.log("CSS variables for dimensions set.");
            }
        }

        // Function to create background particles
        function createParticles(num = 50) { // Tambahkan parameter num
            const container = document.querySelector('.background-particles');
            container.innerHTML = ''; // Bersihkan partikel lama jika ada
            const numParticles = num; // Gunakan parameter num

            for (let i = 0; i < numParticles; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                const size = Math.random() * 8 + 7; // Ukuran lebih bervariasi dan sedikit lebih besar
                particle.style.width = `${size}px`;
                particle.style.height = `${size}px`;
                particle.style.left = `${Math.random() * 100}vw`;
                particle.style.animationDuration = `${Math.random() * 6 + 6}s`; // Durasi lebih panjang
                particle.style.animationDelay = `${Math.random() * 6}s`; // Delay lebih panjang
                container.appendChild(particle);
            }
        }

        // Function to create firework effect
        function createFirework() {
            const firework = document.createElement('div');
            firework.classList.add('firework');
            firework.style.left = `${Math.random() * 80 + 10}vw`;
            firework.style.top = `${Math.random() * 40 + 10}vh`;
            document.body.appendChild(firework);

            firework.addEventListener('animationend', () => {
                firework.remove();
            });
        }

        // Function to populate player dropdowns for all brackets
        function populateAllPlayerDropdowns() {
            ['singles', 'doubles', 'mix-doubles'].forEach(bracketType => {
                const bracketElement = document.getElementById(`${bracketType}-bracket`);
                if (!bracketElement) return;

                bracketElement.querySelectorAll('.match').forEach(match => {
                    const player1Select = match.querySelector('.player[data-player="1"] .player-name-select');
                    const player2Select = match.querySelector('.player[data-player="2"] .player-name-select');

                    if (!player1Select || !player2Select) {
                        return;
                    }

                    // Clear existing options except the first "Select Player"
                    Array.from(player1Select.options).forEach((option, index) => {
                        if (index > 0) option.remove();
                    });
                    Array.from(player2Select.options).forEach((option, index) => {
                        if (index > 0) option.remove();
                    });


                    let playersToPopulate = [];
                    if (bracketType === 'singles') {
                        playersToPopulate = allPlayers;
                    } else if (bracketType === 'doubles') {
                        playersToPopulate = [
                            'RAKA & FADIL ', 'PUTRA & HARYO',
                            'EDWIN & WAHYU YIB', 'RANGGA & ANDI S',
                            'ANDY R & GALIH', 'BRIAN & DAYAT',
                            'QOSIM & WAHYU A', 'HUSNI & BINTANG'
                        ];
                    } else if (bracketType === 'mix-doubles') {
                        playersToPopulate = initialPlayerAssignments['mix-doubles']['all-mix-players'];
                    }

                    playersToPopulate.forEach(player => {
                        const option1 = document.createElement('option');
                        option1.value = player;
                        option1.textContent = player;
                        player1Select.appendChild(option1);

                        const option2 = document.createElement('option');
                        option2.value = player;
                        option2.textContent = player;
                        player2Select.appendChild(option2);
                    });

                    const matchId = match.getAttribute('data-match-id');
                    if (bracketType === 'singles' && matchId.includes('qf')) {
                        const initialPlayers = initialPlayerAssignments['singles'][matchId.split('-')[1]];
                        if (initialPlayers) {
                            player1Select.value = initialPlayers[0];
                            player2Select.value = initialPlayers[1];
                        }
                    } else if (bracketType === 'doubles' && matchId.includes('qf')) {
                        const initialPlayers = initialPlayerAssignments['doubles'][matchId.split('-')[1]];
                        if (initialPlayers) {
                            player1Select.value = initialPlayers[0];
                            player2Select.value = initialPlayers[1];
                        }
                    } else if (bracketType === 'mix-doubles' && matchId.includes('r16')) {
                        const initialPlayers = initialPlayerAssignments['mix-doubles'][matchId.split('-')[1]];
                        if (initialPlayers) {
                            player1Select.value = initialPlayers[0];
                            player2Select.value = initialPlayers[1];
                        }
                    }
                });
            });
        }

        function updateLiveScoreboardOnInput(event) {
            const match = event.target.closest('.match');
            if (liveMatchId === match.getAttribute('data-match-id')) {
                updateLiveScoreboard(match);
            }
        }

        function changeTab(tab) {
            // Hentikan live score saat mengganti tab
            if (liveMatchId) {
                // Set liveMatchId ke null di Firestore
                if (isAdmin) {
                    db.collection('config').doc('liveMatch').set({
                        liveMatchId: null,
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                liveMatchId = null; // Set liveMatchId lokal ke null
            }
            closeLiveScore(); // Tutup scoreboard secara visual

            currentTab = tab;
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelector(`.tab[onclick="changeTab('${tab}')"]`).classList.add('active');

            document.getElementById('singles-bracket').classList.add('hidden');
            document.getElementById('doubles-bracket').classList.add('hidden');
            document.getElementById('mix-doubles-bracket').classList.add('hidden');

            document.getElementById(`${tab}-bracket`).classList.remove('hidden');
            localStorage.setItem('currentTab', tab);
        }

        function toggleLiveScore(matchId) {
            // Hanya admin yang bisa memilih pertandingan live
            if (!isAdmin) {
                alert("Only administrators can select live matches.");
                return;
            }

            // Jika ada pertandingan live sebelumnya, hapus kelas 'live-match' dan indikator
            if (liveMatchId) {
                const prevLiveMatch = document.querySelector(`.match[data-match-id="${liveMatchId}"]`);
                if (prevLiveMatch) {
                    prevLiveMatch.classList.remove('live-match');
                    const prevIndicator = prevLiveMatch.querySelector('.live-indicator');
                    if (prevIndicator) {
                        prevIndicator.remove();
                    }
                }
            }

            // Set pertandingan yang baru sebagai live
            const match = document.querySelector(`.match[data-match-id="${matchId}"]`);
            if (match) {
                match.classList.add('live-match');
                liveMatchId = matchId; // Update variabel global liveMatchId
                updateLiveScoreboard(match); // Perbarui tampilan scoreboard lokal
                currentSet = 1; // Reset set saat memulai live baru
                document.getElementById('current-set').textContent = `Set ${currentSet}`;
                document.getElementById('match-status').textContent = 'Playing';
                updateProgressBar();
                document.getElementById('live-scoreboard').classList.remove('hidden');

                // Tambahkan live indicator
                let liveIndicator = match.querySelector('.live-indicator');
                if (!liveIndicator) {
                    liveIndicator = document.createElement('div');
                    liveIndicator.classList.add('live-indicator');
                    match.appendChild(liveIndicator);
                }

                // Simpan liveMatchId yang baru ke Firestore
                saveData();
            }
        }

        function closeLiveScore() {
            if (liveMatchId) {
                const currentLiveMatchElement = document.querySelector(`.match[data-match-id="${liveMatchId}"]`);
                if (currentLiveMatchElement) {
                    currentLiveMatchElement.classList.remove('live-match');
                    const currentIndicator = currentLiveMatchElement.querySelector('.live-indicator');
                    if (currentIndicator) {
                        currentIndicator.remove();
                    }
                }
            }
            document.getElementById('live-scoreboard').classList.add('hidden');
            clearInterval(matchInterval);
            matchInterval = null;
            liveMatchId = null; // Set liveMatchId lokal ke null
            // Tidak perlu memanggil saveData() di sini karena sudah dipanggil di toggleLiveScore
            // atau di changeTab, atau akan dipicu oleh listener Firestore jika admin menghentikannya
            // dari perangkat lain.
        }

        function setupLiveMatchListener() {
            // Hentikan listener sebelumnya jika ada
            if (unsubscribeLiveMatchListener) {
                unsubscribeLiveMatchListener();
            }

            unsubscribeLiveMatchListener = db.collection('config').doc('liveMatch')
                .onSnapshot(async (doc) => {
                    if (doc.exists) {
                        const data = doc.data();
                        const newLiveMatchId = data.liveMatchId;

                        // Jika liveMatchId berubah atau baru diatur
                        if (newLiveMatchId !== liveMatchId) {
                            // Hapus kelas 'live-match' dan indikator dari pertandingan sebelumnya (jika ada)
                            if (liveMatchId) {
                                const prevLiveMatchElement = document.querySelector(`.match[data-match-id="${liveMatchId}"]`);
                                if (prevLiveMatchElement) {
                                    prevLiveMatchElement.classList.remove('live-match');
                                    const prevIndicator = prevLiveMatchElement.querySelector('.live-indicator');
                                    if (prevIndicator) {
                                        prevIndicator.remove();
                                    }
                                }
                            }

                            liveMatchId = newLiveMatchId; // Update variabel global

                            if (liveMatchId) {
                                // Temukan pertandingan yang baru live
                                const liveMatchElement = document.querySelector(`.match[data-match-id="${liveMatchId}"]`);
                                if (liveMatchElement) {
                                    // Pastikan bracket yang sesuai ditampilkan
                                    const bracketId = liveMatchElement.closest('.bracket').id;
                                    const tabToActivate = bracketId.replace('-bracket', '');
                                    if (currentTab !== tabToActivate) {
                                        // Ganti tab secara otomatis jika pertandingan live ada di tab lain
                                        // Panggil changeTab tanpa menyimpan ke Firestore lagi
                                        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                                        document.querySelector(`.tab[onclick="changeTab('${tabToActivate}')"]`).classList.add('active');

                                        document.getElementById('singles-bracket').classList.add('hidden');
                                        document.getElementById('doubles-bracket').classList.add('hidden');
                                        document.getElementById('mix-doubles-bracket').classList.add('hidden');

                                        document.getElementById(`${tabToActivate}-bracket`).classList.remove('hidden');
                                        localStorage.setItem('currentTab', tabToActivate);
                                        currentTab = tabToActivate; // Update currentTab global
                                    }

                                    liveMatchElement.classList.add('live-match');
                                    updateLiveScoreboard(liveMatchElement);
                                    document.getElementById('live-scoreboard').classList.remove('hidden');

                                    // Tambahkan live indicator
                                    let liveIndicator = liveMatchElement.querySelector('.live-indicator');
                                    if (!liveIndicator) {
                                        liveIndicator = document.createElement('div');
                                        liveIndicator.classList.add('live-indicator');
                                        liveMatchElement.appendChild(liveIndicator);
                                    }

                                    console.log(`Live match updated to: ${liveMatchId}`);
                                } else {
                                    // Jika pertandingan live tidak ditemukan di UI saat ini (misal, belum dimuat)
                                    console.warn(`Live match element with ID ${liveMatchId} not found in current DOM.`);
                                    closeLiveScore(); // Tutup scoreboard jika pertandingan tidak ditemukan
                                }
                            } else {
                                // Jika liveMatchId null, berarti tidak ada pertandingan yang live
                                closeLiveScore();
                                console.log("No live match currently selected.");
                            }
                        }
                    } else {
                        // Dokumen liveMatch tidak ada, berarti tidak ada pertandingan live
                        if (liveMatchId) {
                            closeLiveScore();
                            liveMatchId = null;
                            console.log("Live match document does not exist.");
                        }
                    }
                }, (error) => {
                    console.error("Error listening to live match document:", error);
                });
        }


        function updateLiveScoreboard(match) {
            const player1Select = match.querySelector('.player[data-player="1"] .player-name-select');
            const player2Select = match.querySelector('.player[data-player="2"] .player-name-select');

            document.getElementById('live-player-1').textContent = player1Select ? player1Select.value : 'N/A';
            document.getElementById('live-player-2').textContent = player2Select ? player2Select.value : 'N/A';

            const scores1Container = document.getElementById('live-scores-1');
            const scores2Container = document.getElementById('live-scores-2');

            scores1Container.innerHTML = '';
            scores2Container.innerHTML = '';

            const p1ScoreInputs = match.querySelectorAll('.player[data-player="1"] .score-input');
            const p2ScoreInputs = match.querySelectorAll('.player[data-player="2"] .score-input');

            let currentSetDisplay = 1;
            let maxScoreReached = false;

            for (let i = 0; i < p1ScoreInputs.length; i++) {
                const p1s = parseInt(p1ScoreInputs[i].value);
                const p2s = parseInt(p2ScoreInputs[i].value);

                const scoreEl1 = document.createElement('div');
                scoreEl1.className = 'w-8 text-center font-medium';
                scoreEl1.textContent = p1s;
                scores1Container.appendChild(scoreEl1);

                const scoreEl2 = document.createElement('div');
                scoreEl2.className = 'w-8 text-center font-medium';
                scoreEl2.textContent = p2s;
                scores2Container.appendChild(scoreEl2);

                // Determine current active set for display
                if ((p1s > 0 || p2s > 0) && !maxScoreReached) {
                    currentSetDisplay = i + 1;
                }
                if ((p1s >= 21 && (p1s - p2s >= 2 || p1s === 30)) || (p2s >= 21 && (p2s - p1s >= 2 || p2s === 30))) {
                    maxScoreReached = true; // Set ini sudah selesai
                    if (i + 1 < p1ScoreInputs.length) { // Jika ada set berikutnya
                        currentSetDisplay = i + 2; // Pindah ke set berikutnya
                    }
                }
            }

            // Highlight the current active set in the live scoreboard
            const liveScoreElements1 = scores1Container.children;
            const liveScoreElements2 = scores2Container.children;
            if (liveScoreElements1[currentSetDisplay - 1]) {
                liveScoreElements1[currentSetDisplay - 1].classList.add('text-blue-500');
            }
            if (liveScoreElements2[currentSetDisplay - 1]) {
                liveScoreElements2[currentSetDisplay - 1].classList.add('text-blue-500');
            }

            currentSet = currentSetDisplay; // Update global currentSet
            document.getElementById('current-set').textContent = `Set ${currentSet}`;

            updateProgressBar();
        }


        function updateProgressBar() {
            if (!liveMatchId) return;
            const match = document.querySelector(`.match[data-match-id="${liveMatchId}"]`);
            if (!match) return;

            const player1 = match.querySelector('.player[data-player="1"]');
            const player2 = match.querySelector('.player[data-player="2"]');

            if (!player1 || !player2) {
                document.getElementById('progress-bar').style.width = '0%';
                document.getElementById('current-set').textContent = `Set ${currentSet}`;
                return;
            }

            const p1ScoreInput = player1.querySelector(`.score-input[data-set="${currentSet}"]`);
            const p2ScoreInput = player2.querySelector(`.score-input[data-set="${currentSet}"]`);

            if (!p1ScoreInput || !p2ScoreInput) {
                document.getElementById('progress-bar').style.width = '0%';
                document.getElementById('current-set').textContent = `Set ${currentSet}`;
                return;
            }

            const p1Score = parseInt(p1ScoreInput.value);
            const p2Score = parseInt(p2ScoreInput.value);

            const totalPoints = p1Score + p2Score;

            if (totalPoints > 0) {
                const p1Percentage = (p1Score / totalPoints) * 100;
                document.getElementById('progress-bar').style.width = `${p1Percentage}%`;
            } else {
                document.getElementById('progress-bar').style.width = '0%';
            }

            document.getElementById('current-set').textContent = `Set ${currentSet}`;
        }

        // Fungsi untuk meneruskan pemenang ke pertandingan berikutnya
        function advanceWinner(winnerName, currentMatchId) {
            const [bracketType, round, matchNum] = currentMatchId.split('-');
            let nextMatchId = null;
            let targetPlayerSlot = null; // 1 for player1, 2 for player2

            if (bracketType === 'singles' || bracketType === 'doubles') {
                if (round === 'qf') {
                    const qfMatchNum = parseInt(matchNum);
                    if (qfMatchNum === 1) {
                        nextMatchId = `${bracketType}-sf1`;
                        targetPlayerSlot = 1;
                    } else if (qfMatchNum === 2) {
                        nextMatchId = `${bracketType}-sf1`;
                        targetPlayerSlot = 2;
                    } else if (qfMatchNum === 3) {
                        nextMatchId = `${bracketType}-sf2`;
                        targetPlayerSlot = 1;
                    } else if (qfMatchNum === 4) {
                        nextMatchId = `${bracketType}-sf2`;
                        targetPlayerSlot = 2;
                    }
                } else if (round === 'sf') {
                    const sfMatchNum = parseInt(matchNum);
                    // Pemenang SF1 ke Final Player 1
                    if (sfMatchNum === 1) {
                        nextMatchId = `${bracketType}-final`;
                        targetPlayerSlot = 1;
                    }
                    // Pemenang SF2 ke Final Player 2
                    else if (sfMatchNum === 2) {
                        nextMatchId = `${bracketType}-final`;
                        targetPlayerSlot = 2;
                    }

                    // Logic for 3rd Place Match
                    const currentMatchElement = document.querySelector(`.match[data-match-id="${currentMatchId}"]`);
                    const matchData = JSON.parse(currentMatchElement.dataset.matchData || '{}');
                    const matchWinner = matchData.matchWinner;

                    let loserName = null;
                    const player1Name = currentMatchElement.querySelector('.player[data-player="1"] .player-name-select').value;
                    const player2Name = currentMatchElement.querySelector('.player[data-player="2"] .player-name-select').value;

                    if (matchWinner === player1Name) {
                        loserName = player2Name;
                    } else if (matchWinner === player2Name) {
                        loserName = player1Name;
                    }

                    if (loserName) {
                        const thirdPlaceMatchElement = document.querySelector(`.match[data-match-id="${bracketType}-3rd-place"]`);
                        if (thirdPlaceMatchElement) {
                            if (sfMatchNum === 1) {
                                const targetSelect = thirdPlaceMatchElement.querySelector('.player[data-player="1"] .player-name-select');
                                if (targetSelect && targetSelect.value !== loserName) {
                                    if (!Array.from(targetSelect.options).some(opt => opt.value === loserName)) {
                                        const newOption = document.createElement('option');
                                        newOption.value = loserName;
                                        newOption.textContent = loserName;
                                        targetSelect.appendChild(newOption);
                                    }
                                    targetSelect.value = loserName;
                                    console.log(`Advanced ${loserName} (loser of ${currentMatchId}) to ${bracketType}-3rd-place slot 1`);
                                    targetSelect.dispatchEvent(new Event('change'));
                                }
                            } else if (sfMatchNum === 2) {
                                const targetSelect = thirdPlaceMatchElement.querySelector('.player[data-player="2"] .player-name-select');
                                if (targetSelect && targetSelect.value !== loserName) {
                                    if (!Array.from(targetSelect.options).some(opt => opt.value === loserName)) {
                                        const newOption = document.createElement('option');
                                        newOption.value = loserName;
                                        newOption.textContent = loserName;
                                        targetSelect.appendChild(newOption);
                                    }
                                    targetSelect.value = loserName;
                                    console.log(`Advanced ${loserName} (loser of ${currentMatchId}) to ${bracketType}-3rd-place slot 2`);
                                    targetSelect.dispatchEvent(new Event('change'));
                                }
                            }
                        }
                    }
                }
            } else if (bracketType === 'mix-doubles') {
                if (round === 'r16') {
                    const r16MatchNum = parseInt(matchNum);
                    if (r16MatchNum === 1) {
                        nextMatchId = `${bracketType}-qf1`;
                        targetPlayerSlot = 1;
                    } else if (r16MatchNum === 2) {
                        nextMatchId = `${bracketType}-qf1`;
                        targetPlayerSlot = 2;
                    } else if (r16MatchNum === 3) {
                        nextMatchId = `${bracketType}-qf2`;
                        targetPlayerSlot = 1;
                    }
                    // Handle byes for mix-doubles
                    // If r16-bye1 is the winner, it goes to mix-doubles-qf2 player 2
                    // If r16-bye2 is the winner, it goes to mix-doubles-qf3 player 1
                    // This assumes byes are handled by simply advancing the player who got the bye
                    // For now, we'll assume byes are not "matches" that trigger advanceWinner
                    // but rather pre-filled slots.
                } else if (round === 'qf') {
                    const qfMatchNum = parseInt(matchNum);
                    if (qfMatchNum === 1) {
                        nextMatchId = `${bracketType}-sf1`;
                        targetPlayerSlot = 1;
                    } else if (qfMatchNum === 2) {
                        nextMatchId = `${bracketType}-sf1`;
                        targetPlayerSlot = 2;
                    } else if (qfMatchNum === 3) {
                        nextMatchId = `${bracketType}-sf2`;
                        targetPlayerSlot = 1;
                    } else if (qfMatchNum === 4) {
                        nextMatchId = `${bracketType}-sf2`;
                        targetPlayerSlot = 2;
                    }
                } else if (round === 'sf') {
                    const sfMatchNum = parseInt(matchNum);
                    // Pemenang SF1 ke Final Player 1
                    if (sfMatchNum === 1) {
                        nextMatchId = `${bracketType}-final`;
                        targetPlayerSlot = 1;
                    }
                    // Pemenang SF2 ke Final Player 2
                    else if (sfMatchNum === 2) {
                        nextMatchId = `${bracketType}-final`;
                        targetPlayerSlot = 2;
                    }
                    // Logic for 3rd Place Match
                    const currentMatchElement = document.querySelector(`.match[data-match-id="${currentMatchId}"]`);
                    const matchData = JSON.parse(currentMatchElement.dataset.matchData || '{}');
                    const matchWinner = matchData.matchWinner;

                    let loserName = null;
                    const player1Name = currentMatchElement.querySelector('.player[data-player="1"] .player-name-select').value;
                    const player2Name = currentMatchElement.querySelector('.player[data-player="2"] .player-name-select').value;

                    if (matchWinner === player1Name) {
                        loserName = player2Name;
                    } else if (matchWinner === player2Name) {
                        loserName = player1Name;
                    }

                    if (loserName) {
                        const thirdPlaceMatchElement = document.querySelector(`.match[data-match-id="${bracketType}-3rd-place"]`);
                        if (thirdPlaceMatchElement) {
                            if (sfMatchNum === 1) {
                                const targetSelect = thirdPlaceMatchElement.querySelector('.player[data-player="1"] .player-name-select');
                                if (targetSelect && targetSelect.value !== loserName) {
                                    if (!Array.from(targetSelect.options).some(opt => opt.value === loserName)) {
                                        const newOption = document.createElement('option');
                                        newOption.value = loserName;
                                        newOption.textContent = loserName;
                                        targetSelect.appendChild(newOption);
                                    }
                                    targetSelect.value = loserName;
                                    console.log(`Advanced ${loserName} (loser of ${currentMatchId}) to ${bracketType}-3rd-place slot 1`);
                                    targetSelect.dispatchEvent(new Event('change'));
                                }
                            } else if (sfMatchNum === 2) {
                                const targetSelect = thirdPlaceMatchElement.querySelector('.player[data-player="2"] .player-name-select');
                                if (targetSelect && targetSelect.value !== loserName) {
                                    if (!Array.from(targetSelect.options).some(opt => opt.value === loserName)) {
                                        const newOption = document.createElement('option');
                                        newOption.value = loserName;
                                        newOption.textContent = loserName;
                                        targetSelect.appendChild(newOption);
                                    }
                                    targetSelect.value = loserName;
                                    console.log(`Advanced ${loserName} (loser of ${currentMatchId}) to ${bracketType}-3rd-place slot 2`);
                                    targetSelect.dispatchEvent(new Event('change'));
                                }
                            }
                        }
                    }
                }
            }

            if (nextMatchId && targetPlayerSlot) {
                const nextMatchElement = document.querySelector(`.match[data-match-id="${nextMatchId}"]`);
                if (nextMatchElement) {
                    const targetSelect = nextMatchElement.querySelector(`.player[data-player="${targetPlayerSlot}"] .player-name-select`);
                    if (targetSelect && targetSelect.value !== winnerName) {
                        // Add option if not exists
                        if (!Array.from(targetSelect.options).some(opt => opt.value === winnerName)) {
                            const newOption = document.createElement('option');
                            newOption.value = winnerName;
                            newOption.textContent = winnerName;
                            targetSelect.appendChild(newOption);
                        }
                        targetSelect.value = winnerName;
                        console.log(`Advanced ${winnerName} from ${currentMatchId} to ${nextMatchId} slot ${targetPlayerSlot}`);
                        // Trigger change event to ensure UI updates and data is saved
                        targetSelect.dispatchEvent(new Event('change'));
                    }
                }
            }
        }

        // Fungsi untuk memproses semua pemenang di bracket
        function processBracketWinners() {
            ['singles', 'doubles', 'mix-doubles'].forEach(bracketType => {
                const bracketElement = document.getElementById(`${bracketType}-bracket`);
                if (!bracketElement) return;

                // Urutan pemrosesan penting: R16 -> QF -> SF -> 3rd Place -> Final
                const roundsInOrder = ['r16', 'qf', 'sf', '3rd-place', 'final'];

                roundsInOrder.forEach(roundPrefix => {
                    bracketElement.querySelectorAll(`.match[data-match-id^="${bracketType}-${roundPrefix}"]`).forEach(match => {
                        const matchId = match.getAttribute('data-match-id');
                        const matchData = JSON.parse(match.dataset.matchData || '{}');
                        const matchWinner = matchData.matchWinner;

                        if (matchWinner) {
                            advanceWinner(matchWinner, matchId);
                        }
                    });
                });
            });
        }


        function updateWinner(event) {
            const match = event.target.closest('.match');
            if (!match) return;

            const player1Select = match.querySelector('.player[data-player="1"] .player-name-select');
            const player2Select = match.querySelector('.player[data-player="2"] .player-name-select');
            const player1Div = match.querySelector('.player[data-player="1"]');
            const player2Div = match.querySelector('.player[data-player="2"]');

            if (!player1Select || !player2Select) {
                return;
            }

            const p1ScoreInputs = Array.from(match.querySelectorAll('.player[data-player="1"] .score-input'));
            const p2ScoreInputs = Array.from(match.querySelectorAll('.player[data-player="2"] .score-input'));

            let p1SetWins = 0;
            let p2SetWins = 0;
            const setWinners = [];
            let matchCompleted = false;
            let matchWinner = null;

            for (let i = 0; i < Math.min(p1ScoreInputs.length, p2ScoreInputs.length); i++) {
                const p1s = parseInt(p1ScoreInputs[i].value);
                const p2s = parseInt(p2ScoreInputs[i].value);

                if (p1s >= 21 && (p1s - p2s >= 2 || p1s === 30)) {
                    p1SetWins++;
                    setWinners[i] = 'player1';
                } else if (p2s >= 21 && (p2s - p1s >= 2 || p2s === 30)) {
                    p2SetWins++;
                    setWinners[i] = 'player2';
                } else {
                    setWinners[i] = null;
                }
            }

            player1Div.classList.remove('winner');
            player2Div.classList.remove('winner');

            if (p1SetWins >= 2) { // Best of 3 sets, so 2 wins means match won
                player1Div.classList.add('winner');
                matchWinner = player1Select.value;
                matchCompleted = true;
            } else if (p2SetWins >= 2) { // Best of 3 sets, so 2 wins means match won
                player2Div.classList.add('winner');
                matchWinner = player2Select.value;
                matchCompleted = true;
            }

            match.dataset.matchData = JSON.stringify({
                setWinners: setWinners,
                matchWinner: matchWinner // Simpan pemenang pertandingan
            });

            if (liveMatchId === match.getAttribute('data-match-id')) {
                let activeSetFound = false;
                for (let i = 0; i < p1ScoreInputs.length; i++) {
                    if (parseInt(p1ScoreInputs[i].value) !== 0 || parseInt(p2ScoreInputs[i].value) !== 0) {
                        currentSet = i + 1;
                        activeSetFound = true;
                        break;
                    }
                }
                if (!activeSetFound) {
                    currentSet = 1;
                }

                updateLiveScoreboard(match);
                if (matchCompleted) {
                    document.getElementById('match-status').textContent = 'Match Completed';
                } else {
                    document.getElementById('match-status').textContent = 'Playing';
                }
            }

            // Jika pertandingan selesai, panggil advanceWinner
            if (matchCompleted && matchWinner) {
                advanceWinner(matchWinner, match.getAttribute('data-match-id'));
            }

            saveData();
        }

        window.onload = initTournament;
    </script>
</body>
</html>
